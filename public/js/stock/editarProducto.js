import{cargarDropDowns,recargarTabla,previewImagen,limpiarFormulario}from"./helpers.js";let llenarCampos=o=>{$.ajax({url:""+window.location.origin+endpoints.productosApi+"/"+o,method:"GET",success:o=>{console.log(o),$("#sku").val(o.sku),$("#nombre").val(o.nombre),$("#stock").val(""),$("#precio").val(o.precio),$("#marca").val(o.marcaId),$("#categoria").val(o.categoriaId),$("#capacidad").val(o.capacidad),$("#unidadMedida").val(o.unidadId),$("#proveedor").val(o.proveedorId),$("#previewImage").attr("src",o.img),$("#stockActual").text(o.stock),$("#stockInfoActual").removeClass("d-none"),$("#stockActual").removeClass("d-none")},error:o=>{console.error("Error al cargar el producto",o)}})},actualizarStock=()=>{console.log("Info actual",parseInt($("#stockActual").text()));var o=parseInt($("#stock").val())+parseInt($("#stockActual").text());$("#stockInfoPosterior").text(`NUEVO stock a guardar= ${o} ---> Valor anterior:${parseInt($("#stockActual").text())} + Valor ingresado:`+parseInt($("#stock").val())),$("#stockInfoPosterior").addClass("bg-custom-green mt-2 p-2 text-dark rounded fw-bold"),$("#stockInfoPosterior").removeClass("d-none")};export default t=>{$("#productos").on("click","#editar",function(){$("#stock").off("change").on("change",function(){actualizarStock()}),limpiarFormulario();let e=$(this).data("id");$("#sku").prop("disabled",!0),$("#stock").prop("required",!1),cargarDropDowns().then(()=>{llenarCampos(e),previewImagen(),$("#formModalId").off("submit").on("submit",function(o){o.preventDefault();var a,r,o=new FormData(this);$("#stock").val()?(a=parseInt($("#stock").val())+parseInt($("#stockActual").text()),o.set("stock",a)):o.set("stock",parseInt($("#stockActual").text())),""===$("#formFile").val()&&o.delete("imagen");for(r of o.entries())console.log(r[0]+", "+r[1]);$.ajax({url:""+window.location.origin+endpoints.editarProducto+"/"+e,type:"PUT",data:o,contentType:!1,processData:!1,success:function(o){swal(o.message,"Editado","success"),recargarTabla(t),$("#modalProducto").modal("hide")},error:function(o,a,r){o=JSON.parse(o.responseText).message;swal(o,"Error al editar","error")}})})})})};